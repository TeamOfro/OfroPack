# GitHub Actions でカスタムモデルデータを追加する

このリポジトリでは、GitHub Actionsを使って自動的にカスタムモデルデータを追加できます。

## 使い方: Issueから実行

1. GitHubリポジトリの **Issues** タブに移動
2. **"New issue"** をクリック
3. **"カスタムモデルデータの追加リクエスト"** テンプレートを選択
4. フォームに必要な情報を入力：
   - **マテリアル**: マテリアル名（カンマ区切り、例: `diamond_axe,iron_sword`）
   - **カスタムモデルデータ名**: カスタムモデルデータ名（必須、小文字・数字・アンダースコアのみ）
   - **画像URL**: 画像ファイルのURL（直接アクセス可能なURL）
   - **Frametime（オプション）**: アニメーションテクスチャの場合のみ指定（1フレームあたりのtick数、例: 1, 2, 5）
5. Issueを作成

Issueが作成されると、自動的にワークフローが実行され、Pull Requestが作成されます。
処理が完了すると、Issueにコメントが追加され、**画像のプレビュー（256×256）**が表示されます。

**重要**: エラーが発生した場合、Issueは自動的にクローズされます。修正する場合は、**新しいIssueを作成**してください（既存のIssueを編集しても再実行されません）。

## 画像URLについて

画像URLは直接アクセス可能な公開URLである必要があります。以下のような方法で画像を公開できます：

- 外部の画像ホスティングサービス（Imgur、imgbb、Gyazoなど）
- Discord添付ファイルのURL（クエリパラメータ付きでも正しく処理されます）

**注意**: ワークフローは画像が正しくダウンロードできたかを検証します。URLが無効だったり、PNG形式でない場合はエラーになります。

## 例

### 通常のテクスチャ

```txt
マテリアル: diamond_axe,iron_sword,golden_hoe
カスタムモデルデータ名: special_weapon
画像URL: https://i.imgur.com/example.png
```

### アニメーションテクスチャ

```txt
マテリアル: diamond_sword
カスタムモデルデータ名: animated_blade
画像URL: https://i.imgur.com/animated_example.png
Frametime: 2
```

## アニメーションテクスチャについて

Minecraftのアニメーションテクスチャは、複数のフレームを縦に並べたPNG画像として作成します。

### 画像形式

- **通常テクスチャ**: 正方形（例: 16×16、32×32、64×64）
- **アニメーションテクスチャ**: 高さが幅の整数倍（例: 16×48は3フレーム、16×80は5フレーム）
- すべての次元は2の累乗である必要があります（16, 32, 64, 128など）

### Frametimeについて

- **Frametime**: 1フレームあたりのtick数（1 tick = 1/20秒）
- 例:
  - `frametime: 1` → 1tick/フレーム（0.05秒/フレーム、最速）
  - `frametime: 2` → 2tick/フレーム（0.1秒/フレーム、高速）
  - `frametime: 5` → 5tick/フレーム（0.25秒/フレーム、中速）
  - `frametime: 20` → 20tick/フレーム（1秒/フレーム、低速）
- 省略した場合、通常の静止画テクスチャとして扱われます
- 0は無効なため指定できません（無視されます）

### アニメーションの仕組み

1. 画像をフレーム数で分割（例: 16×80の画像は16×16のフレーム5枚）
2. 指定されたframetimeで順番に表示
3. 自動的に`.mcmeta`ファイルが生成されます

## 注意事項

- マテリアル名は小文字で記述してください
- カスタムモデルデータ名は**必須**で、英小文字、数字、アンダースコアのみ使用可能
- 画像ファイルはPNG形式である必要があります
- 画像URLは直接アクセス可能な公開URLを使用してください（Imgur、Discord添付など）
- ワークフローは画像のダウンロードとPNG形式を自動検証します
- **画像サイズについて**:
  - 通常テクスチャ: 正方形（16×16、32×32など）である必要があります
  - アニメーションテクスチャ: frametimeを指定し、高さが幅の整数倍（16×48、16×80など）である必要があります
  - すべての次元は2の累乗（16, 32, 64, 128など）である必要があります
- 同じカスタムモデルデータ名が既に存在する場合、エラーになります
- **エラーが発生した場合、Issueは自動的にクローズされます。新しいIssueを作成してください**
- Issueの編集では再実行されません（意図的な仕様）

## 処理の流れ

ワークフローは以下のステップを自動実行します：

1. Issueの内容を解析
2. 🚀 処理開始のReactionを追加
3. 画像をダウンロードして検証（PNG形式チェック）
4. カスタムモデルデータをリソースパックに追加
5. プレビュー画像（256×256）を生成
6. Pull Requestを自動作成
7. Issueに結果をコメント（成功時は✅、失敗時は❌）

すべての処理はRust製のCLIツール（`processor`）によって実行され、高速かつ安全に動作します。
